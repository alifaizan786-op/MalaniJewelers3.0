<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0" />
    <title>10-Year Gold Price Chart</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
      .container {
        max-width: 1400px;
        margin: 40px auto;
        padding: 0 20px;
      }

      .live-price {
        background-image: url('./assets/Malani_Gold_Rate_Banner.webp');
        display: flex;
        justify-content: flex-end;
        align-items: center;
        flex-direction: row;
        background-attachment: fixed;
        background-position: bottom;
        background-repeat: no-repeat;
        background-size: cover;
      }

      .live-price .table-wrapper {
        flex: 1 1 350px;
        max-width: 600px;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 1rem;
        margin: 2rem;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
      }

      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 40px;
        font-size: 1.1em;
      }

      .chart-container {
        position: relative;
        width: 100%;
        height: 400px;
        margin: 20px 0;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .stat-card {
        background: rgba(207, 169, 107, 0.8);
        color: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 8px 16px rgba(207, 169, 107, 0.3);
      }

      .stat-value {
        font-size: 2em;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 0.9em;
        opacity: 0.9;
      }

      @media (max-width: 768px) {
        .container {
          margin: 10px;
          padding: 20px;
        }

        .chart-container {
          height: 300px;
        }
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 0.5rem;
        font-size: 0.95rem;
        background-color: #fffdf7;
        border: 1px solid #e0cda9;
      }

      th {
        background-color: #cfa96b;
        color: white;
        font-weight: 600;
        padding: 10px;
        text-align: center;
      }

      td {
        padding: 10px;
        border-top: 1px solid #e0cda9;
        text-align: left;
      }

      td:nth-child(2),
      td:nth-child(3) {
        text-align: right;
      }

      tr:hover td {
        background-color: #fff3e0;
      }

      .history-chart {
        /* width: 80%; */
        display: flex;
        justify-content: space-evenly;
        align-items: normal;
        flex-direction: column;
        margin: 0 auto;
        padding: 2rem 0rem;
      }

      .history-chart .history-content {
        max-width: 80%;
        font-family: 'Abhaya Libre', serif;
        line-height: 1.7;
        color: #333;
      }

      .history-chart .history-content h2 {
        font-size: 1.75rem;
        margin-bottom: 1rem;
        border-bottom: #cfa96b 1px solid;
      }

      .history-chart .history-content p {
        font-size: 1.25rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="live-price">
        <div class="table-wrapper"></div>
      </div>

      <div class="history-chart">
        <h2>
          ðŸ“ˆ 10 Years of Rising Gold Value â€” A Smart Choice for Your
          Future
        </h2>

        <div class="chart-container">
          <canvas id="goldChart"></canvas>
        </div>

        <div class="stats">
          <div class="stat-card">
            <div
              class="stat-value"
              id="minPrice">
              $1,298
            </div>
            <div class="stat-label">Lowest Price (2015)</div>
          </div>
          <div class="stat-card">
            <div
              class="stat-value"
              id="maxPrice">
              $3,500
            </div>
            <div class="stat-label">Highest Price (2025)</div>
          </div>
          <div class="stat-card">
            <div
              class="stat-value"
              id="growth">
              +169%
            </div>
            <div class="stat-label">Total Growth</div>
          </div>
          <div class="stat-card">
            <div
              class="stat-value"
              id="avgGrowth">
              +10.4%
            </div>
            <div class="stat-label">Average Annual Growth</div>
          </div>
        </div>

        <p>
          Gold has always been more than just a symbol of luxury â€”
          itâ€™s a time-tested way to preserve and grow your wealth. At
          Malani Jewelers, we bring you the best of both worlds:
          exquisite gold jewelry that elevates your style while
          safeguarding your financial future.
        </p>
        <p>
          As gold prices continue to rise over the years, every gold
          purchase becomes a smart investment in stability and
          security. Whether you choose a timeless piece of jewelry or
          explore modern gold investment options, Malani ensures
          unmatched quality, transparency, and trust.
        </p>
        <p>
          Invest in gold today â€” because beauty and financial wisdom
          should go hand in hand.
        </p>
      </div>
    </div>

    <script>
      function formatUSD(amount) {
        return new Intl.NumberFormat('en-US', {
          style: 'currency',
          currency: 'USD',
        }).format(amount);
      }

      function formatINR(amount) {
        return new Intl.NumberFormat('en-IN', {
          style: 'currency',
          currency: 'INR',
        }).format(amount);
      }

      const formatDate = (date) =>
        `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(
          2,
          '0'
        )}-${String(date.getDate()).padStart(2, '0')}`;

      const formatDateForChart = (dateStr) => {
        const date = new Date(dateStr);
        return `${String(date.getMonth() + 1).padStart(
          2,
          '0'
        )}/${String(date.getDate()).padStart(2, '0')}`;
      };

      async function fetchLiveGoldDataForTable() {
        const [goldRes, inrRes] = await Promise.all([
          fetch('https://mjplusweb.com/api/proxy/gold-price-api', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              url: `https://api.metalpriceapi.com/v1/carat?api_key=replaceApiKey&base=USD`,
            }),
          }),
          fetch('https://mjplusweb.com/api/proxy/gold-price-api', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              url: `https://api.metalpriceapi.com/v1/latest?api_key=replaceApiKey&base=USD&currencies=INR`,
            }),
          }),
        ]);

        const goldData = await goldRes.json();
        const inrRate = (await inrRes.json()).rates.INR;
        const carats = ['24k', '22k', '18k'];

        const units = [
          { label: '1 Ounce', multiplier: 31.1 },
          { label: '10 gram', multiplier: 10 },
          { label: '1 Tola (11.66 Grams)', multiplier: 11.66 },
          { label: '1 gram', multiplier: 1 },
        ];

        const html = carats
          .map((karat) => {
            const base = goldData.data[karat] * 5;
            return `
        <table>
          <tr><th colspan="3">${karat}t Gold Price</th></tr>
          ${units
            .map(
              ({ label, multiplier }) => `
            <tr>
              <td>${label}</td>
              <td>${formatUSD(base * multiplier)}</td>
              <td>${formatINR(base * multiplier * inrRate)}</td>
            </tr>
          `
            )
            .join('')}
        </table>`;
          })
          .join('');

        document.querySelector('.table-wrapper').innerHTML = html;
      }

      fetchLiveGoldDataForTable();

      const yearLabels = [
        '2015',
        '2016',
        '2017',
        '2018',
        '2019',
        '2020',
        '2021',
        '2022',
        '2023',
        '2024',
        '2025',
      ];

      const yearPrices = [
        1298, 1373, 1351, 1360, 1543, 2058, 1954, 2043, 2115, 2786,
        3500,
      ];

      // Calculate statistics
      const minPrice = Math.min(...yearPrices);
      const maxPrice = Math.max(...yearPrices);
      const firstPrice = yearPrices[0];
      const lastPrice = yearPrices[yearPrices.length - 1];
      const totalGrowth = (
        ((lastPrice - firstPrice) / firstPrice) *
        100
      ).toFixed(1);
      const years = yearPrices.length - 1;
      const avgAnnualGrowth =
        (Math.pow(lastPrice / firstPrice, 1 / years) - 1) * 100;

      // Update stats
      document.getElementById(
        'minPrice'
      ).textContent = `$${minPrice.toLocaleString()}`;
      document.getElementById(
        'maxPrice'
      ).textContent = `$${maxPrice.toLocaleString()}`;
      document.getElementById(
        'growth'
      ).textContent = `+${totalGrowth}%`;
      document.getElementById(
        'avgGrowth'
      ).textContent = `+${avgAnnualGrowth.toFixed(1)}%`;

      const ctx = document
        .getElementById('goldChart')
        .getContext('2d');

      const goldChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: yearLabels,
          datasets: [
            {
              label: 'Gold Price (USD/oz)',
              data: yearPrices,
              borderColor: 'rgba(207,169,107,0.8)',
              backgroundColor: 'rgba(207,169,107,0.1)',
              borderWidth: 3,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: 'rgba(207,169,107,0.8)',
              pointBorderColor: 'rgba(207,169,107,0.9)',
              pointBorderWidth: 2,
              pointRadius: 6,
              pointHoverRadius: 8,
              pointHoverBackgroundColor: 'rgba(207,169,107,0.9)',
              pointHoverBorderColor: 'rgba(207,169,107,1)',
              pointHoverBorderWidth: 3,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            intersect: false,
            mode: 'index',
          },
          plugins: {
            legend: {
              display: false,
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: 'rgba(207,169,107,0.8)',
              bodyColor: 'white',
              borderColor: 'rgba(207,169,107,0.8)',
              borderWidth: 1,
              cornerRadius: 8,
              displayColors: false,
              callbacks: {
                label: function (context) {
                  return `$${context.parsed.y.toLocaleString()} per ounce`;
                },
                afterLabel: function (context) {
                  if (context.dataIndex > 0) {
                    const current = context.parsed.y;
                    const previous =
                      yearPrices[context.dataIndex - 1];
                    const change = (
                      ((current - previous) / previous) *
                      100
                    ).toFixed(1);
                    const symbol = change >= 0 ? '+' : '';
                    return `${symbol}${change}% from previous year`;
                  }
                  return '';
                },
              },
            },
          },
          scales: {
            x: {
              grid: {
                color: 'rgba(0, 0, 0, 0.1)',
                borderColor: 'rgba(0, 0, 0, 0.2)',
              },
              ticks: {
                color: '#666',
                font: {
                  size: 12,
                  weight: 'bold',
                },
              },
            },
            y: {
              beginAtZero: false,
              grid: {
                color: 'rgba(0, 0, 0, 0.1)',
                borderColor: 'rgba(0, 0, 0, 0.2)',
              },
              ticks: {
                color: '#666',
                font: {
                  size: 12,
                  weight: 'bold',
                },
                callback: function (value) {
                  return '$' + value.toLocaleString();
                },
              },
            },
          },
          elements: {
            point: {
              hoverRadius: 8,
            },
          },
        },
      });

      // Make chart responsive to window resize
      window.addEventListener('resize', function () {
        goldChart.resize();
      });
    </script>
  </body>
</html>
